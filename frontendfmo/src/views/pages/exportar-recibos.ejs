<!DOCTYPE html>
<html lang="es">
<head>
    <%- include('../partials/head') %>
    <title>Exportar Reportes</title>
<style>
    /* --- 1. ESTILOS ORIGINALES (Tus estilos de siempre) --- */
        .paper-form {
            background-color: #fff;
            border: 2px solid #000;
            color: #000;
            font-family: 'Courier New', Courier, monospace;
            font-size: 13px;
            width: 85%;
            margin: 0 auto;
            height: 70%;
        }
    

        .cell-border {
            border: 1px solid #000;
            padding: 2px 5px;
            display: flex;
            align-items: center;
        }

    .cell-block { display: block; }

        .input-line {
            border: none;
            background: transparent;
            width: 100%;
            font-weight: bold;
            color: #000080;
            height: 20px;
            font-size: 13px;
            padding: 0 5px;
        }
    .input-line:focus { outline: none; }

    .label-text {
        font-weight: bold;
        font-size: 0.75rem;
        text-transform: uppercase;
        white-space: nowrap;
    }

    .form-check {
        min-height: auto;
        margin-bottom: 0;
        margin-right: 10px;
        }
    .form-check-input { 
        border: 1px solid #000 !important; /* Forzar borde en checkbox */
        width: 13px; 
        height: 13px; 
        margin-top: 3px; 
        appearance: auto; /* Ayuda a que html2canvas lo renderice mejor */
    }
    
    .row-compact { --bs-gutter-x: 0; }
    
    .tag-badge {
        background-color: #000080;
        color: white;
        padding: 1px 3px;
        border-radius: 4px;
        margin-right: 4px;
        font-size: 10px;
    }

    /* --- 2. CONFIGURACIÃ“N TÃ‰CNICA PARA LA EXPORTACIÃ“N --- */
    
    /* Contenedor de Templates (OCULTO) */
    #templates-container { display: none; }

    /* Estilo para el contenedor de impresiÃ³n */
    #print-staging-area {
        background: white;
        width: 816px; /* Ancho exacto Carta */
        margin: 0 auto;
    }
    
    /* Salto de pÃ¡gina */
    .html2pdf__page-break {
        height: 20px;
        background: white;
        display: block;
    }

    /* Ocultar botones dentro del PDF por si acaso */
    .paper-form button, .paper-form .btn { display: none !important; }
</style>
</head>
<body>
    <div class="wrapper">
        <%- include('../partials/sidebar') %>
        <div id="content" class="w-100 bg-light p-4 fade-in">
            
            <h4 class="mb-4 fw-bold">ðŸ“¤ ExportaciÃ³n Masiva de Registros</h4>

            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="row g-3 align-items-end">
                        
                        <div class="col-md-3">
                            <label class="form-label fw-bold">Tipo de Registro:</label>
                            <select class="form-select" id="selTipo">
                                <option value="equipos">Recibo de Equipos</option>
                                <option value="perifericos">Recibo de PerifÃ©ricos</option>
                                <option value="daet">Entregas al DAET</option>
                            </select>
                        </div>

                        <div class="col-md-2">
                            <label class="form-label fw-bold">Formato:</label>
                            <select class="form-select" id="selFormato" onchange="toggleFormato()">
                                <option value="pdf">PDF (Documentos)</option>
                                <option value="csv">CSV (Excel)</option>
                            </select>
                        </div>

                        <div class="col-md-2 date-group">
                            <label class="form-label fw-bold">Desde:</label>
                            <input type="date" class="form-control" id="fechaInicio">
                        </div>
                        <div class="col-md-2 date-group">
                            <label class="form-label fw-bold">Hasta:</label>
                            <input type="date" class="form-control" id="fechaFin">
                        </div>

                        <div class="col-md-3">
                            <button class="btn btn-primary w-100" onclick="procesarExportacion()">
                                ðŸš€ Generar ExportaciÃ³n
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="statusArea" class="mt-3"></div>

        </div>
    </div>

<div id="templates-container" style="display:none;">
    <div id="template-equipos-wrapper"><%- include('../partials/forms/template-equipos') %></div>
    <div id="template-perifericos-wrapper"><%- include('../partials/forms/template-perifericos') %></div>
    <div id="template-daet-wrapper"><%- include('../partials/forms/template-daet') %></div>
</div>

<script src="/js/utils/jspdf.umd.min.js"></script>
<script src="/js/utils/html2canvas.min.js"></script>
<script src="/js/bootstrap/bootstrap.bundle.min.js"></script>
<script src="/js/utils/html2pdf.bundle.min.js"></script>
<script src="/js/utils/api.js"></script>
<script src="/js/utils/pdf.js"></script>
<script src="/js/utils/mappings.js"></script>

<script src = "/js/scripts/exportarRecibos.js"></script>

<div id="print-staging-area"></div>

</body>

    
</html>