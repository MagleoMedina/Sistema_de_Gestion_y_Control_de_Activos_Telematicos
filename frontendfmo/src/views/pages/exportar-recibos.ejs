<!DOCTYPE html>
<html lang="es">
<head>
    <%- include('../partials/head') %>
    <title>Exportar Reportes</title>
<style>
    /* --- PALETA FMO --- */
    :root {
        --fmo-red-dark: #dd0303;
        --fmo-red: #d6291c;
        --fmo-orange-red: #f25912;
        --fmo-orange: #fa812f;
        --fmo-yellow: #fab12f;
    }

    .tag-badge {
        background-color: #000080;
        color: white;
        padding: 1px 3px;
        border-radius: 4px;
        margin-right: 4px;
        font-size: 10px;
    }

    .text-fmo-title { color: var(--fmo-red-dark); }

    .btn-fmo {
        background: linear-gradient(to right, var(--fmo-red), var(--fmo-orange-red));
        border: none;
        color: white;
        transition: all 0.3s ease;
    }
    .btn-fmo:hover {
        background: linear-gradient(to right, var(--fmo-red-dark), var(--fmo-red));
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(214, 41, 28, 0.3);
    }
    
    /* Input deshabilitado visualmente */
    .input-disabled-fmo {
        opacity: 0.6;
        pointer-events: none;
        background-color: #e9ecef;
    }

    #templates-container { display: none; }
    #print-staging-area { background: white; width: 816px; margin: 0 auto; }


    /* Salto de página */
    .html2pdf__page-break {
        height: 20px;
        background: white;
        display: block;
    }

    /* Ocultar botones dentro del PDF por si acaso */
    .paper-form button, .paper-form .btn { display: none !important; }

    /* Width específicos para los formatos */
    .paper-form-equipos { max-width: 660px; }
    .paper-form-perifericos { max-width: 500px; }
    .paper-form-daet { max-width: 700px; }

</style>
</head>
<body>
    <div class="wrapper">
        <%- include('../partials/sidebar') %>
        <div id="content" class="w-100 bg-light p-4 fade-in">
            
            <h4 class="mb-4 fw-bold text-fmo-title">
                <i class="bi bi-folder-plus me-2"></i>
                Exportación Masiva de Registros
            </h4>

            <div class="card shadow-sm border-0">
                <div class="card-body">
                    <div class="row g-3 align-items-end">
                        
                        <div class="col-md-3">
                            <label class="form-label fw-bold text-secondary">Tipo de Registro:</label>
                            <select class="form-select" id="selTipo" onchange="gestorInteraccion('tipo')">
                                <option value="equipos">Recibo de Equipos</option>
                                <option value="perifericos">Recibo de Periféricos</option>
                                <option value="daet">Entregas al DAET</option>
                                <option value="casos">Atención al Usuario</option> 
                            </select>
                        </div>

                        <div class="col-md-2">
                            <label class="form-label fw-bold text-secondary">Formato:</label>
                            <select class="form-select" id="selFormato" onchange="gestorInteraccion('formato')">
                                <option value="pdf">PDF</option>
                                <option value="csv">CSV</option>
                            </select>
                        </div>

                        <div class="col-md-2 date-group">
                            <label class="form-label fw-bold text-secondary">Desde:</label>
                            <input type="date" class="form-control" id="fechaInicio">
                        </div>
                        <div class="col-md-2 date-group">
                            <label class="form-label fw-bold text-secondary">Hasta:</label>
                            <input type="date" class="form-control" id="fechaFin">
                        </div>

                        <div class="col-md-3">
                            <button class="btn btn-fmo w-100" onclick="procesarExportacion()">
                                <i class="bi bi-cloud-download-fill me-2"></i>
                                Generar Exportación
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="statusArea" class="mt-3"></div>

        </div>
    </div>

    <div id="templates-container">
        <div id="template-equipos-wrapper"><%- include('../partials/forms/template-equipos') %></div>
        <div id="template-perifericos-wrapper"><%- include('../partials/forms/template-perifericos') %></div>
        <div id="template-daet-wrapper"><%- include('../partials/forms/template-daet') %></div>
    </div>

    <%- include('../partials/modal') %>

    <script src="/js/utils/jspdf.umd.min.js"></script>
    <script src="/js/utils/html2canvas.min.js"></script>
    <script src="/js/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/js/utils/html2pdf.bundle.min.js"></script>
    <script src="/js/utils/api.js"></script>
    <script src="/js/utils/pdf.js"></script>
    <script src="/js/utils/mappings.js"></script>

    <script src="/js/scripts/exportarRecibos.js"></script>
    <div id="print-staging-area"></div>

</body>
</html>

